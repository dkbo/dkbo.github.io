var init={object:{sizeX:32,sizeY:32,sprites:"url('images/rpg_maker_xp.png')"},man:{sprite:"url('images/man.png')",speak:"url('images/speak.png'),pointer",sizeX:32,sizeY:48,moveSetInterVal:1e3/60,moveSpeed:4,initPos:{x:640,y:800}},control:{left:!1,up:!1,right:!1,down:!1},map:{bg:"url('images/bg.jpg')",left:!1,up:!1,right:!1,down:!1}},sX=init.object.sizeX,sY=init.object.sizeY;init.objects=[{styles:[{name:"largetree",id:0,left:800,top:200,width:8*sX,height:7*sY,background:init.object.sprites+" 0 -1056px",zIndex:2},{name:"largetree",id:0,left:800,top:424,width:8*sX,height:3*sY,background:init.object.sprites+" 0 -1280px",mx:800+3*sX,my:392,mw:2*sX,mh:2*sY},{name:"tree1",id:1,left:400,top:900,width:4*sX,height:4*sY,background:init.object.sprites+" 0 -160px",zIndex:2},{name:"tree1",id:1,left:400,top:1028,width:4*sX,height:sY,background:init.object.sprites+" 0 -288px",mx:400+sX,my:1028,mw:2*sX,mh:0},{name:"house",id:2,left:400,top:300,width:3*sX,height:6*sY,background:init.object.sprites+" 0 -5216px",zIndex:2,mx:400,my:300+2*sY,mw:7*sX,mh:5*sY},{name:"house",id:2,left:400,top:492,width:3*sX,height:2*sY,background:init.object.sprites+" 0 -5408px",zIndex:0,mx:400,my:300+2*sY,mw:7*sX,mh:4*sY},{name:"house",id:2,left:492,top:300,width:sX,height:6*sY,background:init.object.sprites+" -64px -5216px",zIndex:2},{name:"house",id:2,left:524,top:300,width:sX,height:7*sY,background:init.object.sprites+" -64px -5216px",zIndex:2},{name:"house",id:2,left:556,top:300,width:sX,height:6*sY,background:init.object.sprites+" -96px -5216px",zIndex:2},{name:"house",id:2,left:588,top:300,width:sX,height:7*sY,background:init.object.sprites+" -128px -5216px",zIndex:2},{name:"house",id:2,left:588,top:524,width:sX,height:sY,background:init.object.sprites+" -128px -5440px"},{name:"housedoor",id:2,left:492,top:492,width:sX,height:2*sY,background:init.object.sprites+" -96px -5408px",mx:492,my:492,mw:sX,mh:sY,cm:1,cmm:0},{name:"house",id:2,left:556,top:492,width:sX,height:sY,background:init.object.sprites+" -64px -5408px"},{name:"house",id:2,left:556,top:524,width:sX,height:sY,background:init.object.sprites+" -64px -5440px"},{name:"house",id:2,left:524,top:524,width:sX,height:sY,background:init.object.sprites+" -64px -5440px"},{name:"wood",id:2,left:524,top:524,width:2*sX,height:2*sY,background:init.object.sprites+" -192px -4672px",mx:524,my:524,mw:2*sX,mh:1*sY},{name:"fence",id:3,left:400,top:624,width:sX,height:2*sY,background:init.object.sprites+" -32px -4480px",mx:400,my:624+sY,mw:10*sX,mh:0},{name:"fence",id:3,left:432,top:624,width:sX,height:2*sY,background:init.object.sprites+" -64px -4480px",mx:400+12*sX,my:624+sY,mw:8*sX,mh:0},{name:"fence",id:3,left:464,top:624,width:sX,height:2*sY,background:init.object.sprites+" -64px -4480px",mx:400,my:848+sY,mw:20*sX,mh:0},{name:"fence",id:3,left:496,top:624,width:sX,height:2*sY,background:init.object.sprites+" -64px -4480px",mx:400,my:624+sY,mw:sX/2,mh:7*sY},{name:"fence",id:3,left:528,top:624,width:sX,height:2*sY,background:init.object.sprites+" -64px -4480px",mx:1004+sX/2,my:624+sY,mw:sX/4,mh:7*sY},{name:"fence",id:3,left:560,top:624,width:sX,height:2*sY,background:init.object.sprites+" -64px -4480px"},{name:"fence",id:3,left:592,top:624,width:sX,height:2*sY,background:init.object.sprites+" -64px -4480px"},{name:"fence",id:3,left:624,top:624,width:sX,height:2*sY,background:init.object.sprites+" -64px -4480px"},{name:"fence",id:3,left:656,top:624,width:sX,height:2*sY,background:init.object.sprites+" -64px -4480px"},{name:"fence",id:3,left:688,top:624,width:sX,height:2*sY,background:init.object.sprites+" -192px -4480px"},{name:"fence",id:3,left:784,top:624,width:sX,height:2*sY,background:init.object.sprites+" -224px -4480px"},{name:"fence",id:3,left:816,top:624,width:sX,height:2*sY,background:init.object.sprites+" -64px -4480px"},{name:"fence",id:3,left:848,top:624,width:sX,height:2*sY,background:init.object.sprites+" -64px -4480px"},{name:"fence",id:3,left:880,top:624,width:sX,height:2*sY,background:init.object.sprites+" -64px -4480px"},{name:"fence",id:3,left:912,top:624,width:sX,height:2*sY,background:init.object.sprites+" -64px -4480px"},{name:"fence",id:3,left:944,top:624,width:sX,height:2*sY,background:init.object.sprites+" -64px -4480px"},{name:"fence",id:3,left:976,top:624,width:sX,height:2*sY,background:init.object.sprites+" -64px -4480px"},{name:"fence",id:3,left:1008,top:624,width:sX,height:2*sY,background:init.object.sprites+" -96px -4480px"},{name:"fence",id:3,left:400,top:848,width:sX,height:2*sY,background:init.object.sprites+" -32px -4576px",zIndex:2},{name:"fence",id:3,left:432,top:848,width:sX,height:2*sY,background:init.object.sprites+" -64px -4576px",zIndex:2},{name:"fence",id:3,left:464,top:848,width:sX,height:2*sY,background:init.object.sprites+" -64px -4576px",zIndex:2},{name:"fence",id:3,left:496,top:848,width:sX,height:2*sY,background:init.object.sprites+" -64px -4576px",zIndex:2},{name:"fence",id:3,left:528,top:848,width:sX,height:2*sY,background:init.object.sprites+" -64px -4576px",zIndex:2},{name:"fence",id:3,left:560,top:848,width:sX,height:2*sY,background:init.object.sprites+" -64px -4576px",zIndex:2},{name:"fence",id:3,left:592,top:848,width:sX,height:2*sY,background:init.object.sprites+" -64px -4576px",zIndex:2},{name:"fence",id:3,left:624,top:848,width:sX,height:2*sY,background:init.object.sprites+" -64px -4576px",zIndex:2},{name:"fence",id:3,left:656,top:848,width:sX,height:2*sY,background:init.object.sprites+" -64px -4576px",zIndex:2},{name:"fence",id:3,left:688,top:848,width:sX,height:2*sY,background:init.object.sprites+" -64px -4576px",zIndex:2},{name:"fence",id:3,left:720,top:848,width:sX,height:2*sY,background:init.object.sprites+" -64px -4576px",zIndex:2},{name:"fence",id:3,left:752,top:848,width:sX,height:2*sY,background:init.object.sprites+" -64px -4576px",zIndex:2},{name:"fence",id:3,left:784,top:848,width:sX,height:2*sY,background:init.object.sprites+" -64px -4576px",zIndex:2},{name:"fence",id:3,left:816,top:848,width:sX,height:2*sY,background:init.object.sprites+" -64px -4576px",zIndex:2},{name:"fence",id:3,left:848,top:848,width:sX,height:2*sY,background:init.object.sprites+" -64px -4576px",zIndex:2},{name:"fence",id:3,left:880,top:848,width:sX,height:2*sY,background:init.object.sprites+" -64px -4576px",zIndex:2},{name:"fence",id:3,left:912,top:848,width:sX,height:2*sY,background:init.object.sprites+" -64px -4576px",zIndex:2},{name:"fence",id:3,left:944,top:848,width:sX,height:2*sY,background:init.object.sprites+" -64px -4576px",zIndex:2},{name:"fence",id:3,left:976,top:848,width:sX,height:2*sY,background:init.object.sprites+" -64px -4576px",zIndex:2},{name:"fence",id:3,left:1008,top:848,width:sX,height:2*sY,background:init.object.sprites+" -96px -4576px",zIndex:2},{name:"fence",id:3,left:400,top:656,width:sX,height:sY,background:init.object.sprites+" -32px -4544px"},{name:"fence",id:3,left:400,top:688,width:sX,height:sY,background:init.object.sprites+" -32px -4544px"},{name:"fence",id:3,left:400,top:720,width:sX,height:sY,background:init.object.sprites+" -32px -4544px"},{name:"fence",id:3,left:400,top:752,width:sX,height:sY,background:init.object.sprites+" -32px -4544px"},{name:"fence",id:3,left:400,top:784,width:sX,height:sY,background:init.object.sprites+" -32px -4544px"},{name:"fence",id:3,left:400,top:816,width:sX,height:sY,background:init.object.sprites+" -32px -4544px"},{name:"fence",id:3,left:400,top:848,width:sX,height:sY,background:init.object.sprites+" -32px -4544px"},{name:"fence",id:3,left:1008,top:656,width:sX,height:sY,background:init.object.sprites+" -96px -4544px"},{name:"fence",id:3,left:1008,top:688,width:sX,height:sY,background:init.object.sprites+" -96px -4544px"},{name:"fence",id:3,left:1008,top:720,width:sX,height:sY,background:init.object.sprites+" -96px -4544px"},{name:"fence",id:3,left:1008,top:752,width:sX,height:sY,background:init.object.sprites+" -96px -4544px"},{name:"fence",id:3,left:1008,top:784,width:sX,height:sY,background:init.object.sprites+" -96px -4544px"},{name:"fence",id:3,left:1008,top:816,width:sX,height:sY,background:init.object.sprites+" -96px -4544px"},{name:"farmland",id:4,left:464,top:728,width:3*sX,height:3*sY,background:init.object.sprites+" -32px -5056px"},{name:"farmland",id:4,left:624,top:728,width:3*sX,height:3*sY,background:init.object.sprites+" -32px -5056px"},{name:"bogy",id:5,left:578,top:728,width:sX,height:sY,background:init.object.sprites+" -96px -4994px",zIndex:2,mx:578,my:728+sY,mw:sX,mh:sY/4,eventID:0,cursor:init.man.speak},{name:"bogy",id:5,left:578,top:760,width:sX,height:sY,background:init.object.sprites+" -96px -5026px",cursor:init.man.speak},{name:"crop",id:5,left:464,top:760,width:sX,height:2*sY,background:init.object.sprites+" -64px -4994px"},{name:"crop",id:5,left:496,top:740,width:sX,height:2*sY,background:init.object.sprites+" -64px -4994px"},{name:"crop",id:5,left:528,top:752,width:sX,height:2*sY,background:init.object.sprites+" -64px -4994px"},{name:"crop",id:5,left:624,top:760,width:sX,height:2*sY,background:init.object.sprites+" -64px -4994px"},{name:"crop",id:5,left:656,top:752,width:sX,height:2*sY,background:init.object.sprites+" -64px -4994px"},{name:"crop",id:5,left:688,top:740,width:sX,height:2*sY,background:init.object.sprites+" -64px -4994px"},{name:"tree2",id:6,left:592,top:900,width:4*sX,height:4*sY,background:init.object.sprites+" 0 -160px",zIndex:2},{name:"tree2",id:6,left:592,top:1028,width:4*sX,height:sY,background:init.object.sprites+" 0 -288px",mx:592+sX,my:1028,mw:2*sX,mh:0},{name:"tree3",id:7,left:784,top:900,width:4*sX,height:4*sY,background:init.object.sprites+" 0 -160px",zIndex:2},{name:"tree3",id:7,left:784,top:1028,width:4*sX,height:sY,background:init.object.sprites+" 0 -288px",mx:784+sX,my:1028,mw:2*sX,mh:0},{name:"tree4",id:8,left:976,top:900,width:4*sX,height:4*sY,background:init.object.sprites+" 0 -160px",zIndex:2},{name:"tree4",id:8,left:976,top:1028,width:4*sX,height:sY,background:init.object.sprites+" 0 -288px",mx:976+sX,my:1028,mw:2*sX,mh:0},{name:"tree5",id:9,left:496,top:964,width:4*sX,height:4*sY,background:init.object.sprites+" 0 -768px",zIndex:2},{name:"tree5",id:9,left:496,top:1092,width:4*sX,height:sY,background:init.object.sprites+" 0 -896px",mx:496+sX,my:1092,mw:2*sX,mh:0},{name:"tree6",id:10,left:688,top:964,width:4*sX,height:4*sY,background:init.object.sprites+" 0 -768px",zIndex:2},{name:"tree6",id:10,left:688,top:1092,width:4*sX,height:sY,background:init.object.sprites+" 0 -896px",mx:688+sX,my:1092,mw:2*sX,mh:0},{name:"tree7",id:11,left:880,top:964,width:4*sX,height:4*sY,background:init.object.sprites+" 0 -768px",zIndex:2},{name:"tree7",id:11,left:880,top:1092,width:4*sX,height:sY,background:init.object.sprites+" 0 -896px",mx:880+sX,my:1092,mw:2*sX,mh:0},{name:"man",id:12,left:810,top:490,width:sX,height:24,background:init.man.sprite+" 0 0",zIndex:2,mx:810,my:490+sY,mw:sX,mh:0,cursor:init.man.speak,eventID:1},{name:"man",id:12,left:810,top:514,width:sX,height:24,background:init.man.sprite+" 0 -24px",cursor:init.man.speak},{name:"stone",id:13,left:980,top:448,width:2*sX,height:2*sY,background:init.object.sprites+" -192px -1664px",zIndex:2,cursor:init.man.speak},{name:"stone",id:13,left:980,top:512,width:2*sX,height:1*sY,background:init.object.sprites+" -192px -1728px",cursor:init.man.speak,mx:980,my:512,mw:2*sX,mh:0,eventID:2}]},{styles:[{name:"housedoor",id:1,left:224,top:320,width:2*sX,height:sY,background:"green",mx:224,my:320,mw:2*sX,mh:sY,cm:0,cmm:0},{name:"man",id:12,left:200,top:144,width:sX,height:24,background:init.man.sprite+" 0 0",zIndex:2,mx:200,my:144+sY,mw:sX,mh:0,cursor:init.man.speak,eventID:0},{name:"man",id:12,left:200,top:168,width:sX,height:24,background:init.man.sprite+" 0 -24px",cursor:init.man.speak}]}],init.event=[[{name:"稻草人",text:[".","..","..."]},{name:"哆拉樹",text:["大家好!","我被作者配置在樹下所以我叫做哆拉樹。","作者說以前有玩過一些用 RPG 製作大師所製成的遊戲，但是從來沒有親自開發過。","現在作者想做一份線上履歷來介紹自己，以 RPG 製作大師的風格來實作!","因作者並不會美編，所以場景布置的不好看也請多多見諒。"]},{name:"古文碑",select:[{title:"世界形成之初",text:["此石碑記載著這個世界的創立因素，上面留有密密麻麻的文字....","世界形成之初，有著 HTML 、 CSS 、 JavaScrit","ReactJs、Jquery 是 JavaScirpt 的兒子，祂們能把世界毀滅亦可重生。","Sass 是 Css 的女兒，在這個世界中，任何事情都逃不過牠的法眼。","而 HTML 則是這世界的別名。","在一次的 Gulp 協議中，JavaScript 及 Css 達成共識，決定讓自己的孩子在 HTML 中歷練。","於是 ReactJs、Jquery、Sass 攜手打造了這個世界。"]},{title:"關於作者",text:[React.createElement("span",null,"作者本名叫 盧宏寶 在家排名老二，畢業於高雄市正修科技大學電機工程系，在網路世界中暱稱為 DKBO，",React.createElement("del",null,"目前已婚有一子"))]}]}],[{name:"哆拉空",text:["這屋子好空啊!該擺些甚麼東西呢!"]}]],init.maps=[{bg:init.map.bg,col:1920,row:1280,"in":[{x:488,y:544}]},{bg:init.map.bg,col:480,row:320,"in":[{x:240,y:260}]}],init.events=[],init.style=[],init.move=[];for(var j=0;j<init.objects.length;j++){init.events[j]=[],init.style[j]=[],init.move[j]=[];for(var xx=0,yy=0,ee=0,i=0;i<init.objects[j].styles.length;i++){var obj=init.objects[j].styles[i];if(obj.mx){var x={sx:obj.mx,sy:obj.my,ex:obj.mw+obj.mx,ey:obj.mh+obj.my,cm:obj.cm,cmm:obj.cmm};init.move[j][xx]=x,xx+=1}if(obj.left){var y={left:obj.left,top:obj.top,width:obj.width,height:obj.height,background:obj.background,zIndex:obj.zIndex,cursor:obj.cursor};init.style[j][yy]=y,yy+=1}if(obj.eventID>=0){var e={sx:obj.mx,sy:obj.my,ex:obj.mw+obj.mx,ey:obj.mh+obj.my,ev:obj.eventID};init.events[j][ee]=e,ee+=1}}}init.arr=[];for(var j=0;j<init.style.length;j++){init.arr[j]=[];for(var i=0;i<init.style[j].length;i++)init.arr[j][i]=React.createElement("div",{className:"objects",name:init.objects[j].styles[i].name,style:init.style[j][i]})}var Root=React.createClass({displayName:"Root",getDefaultProps:function(){return{min:1,left:-init.man.moveSpeed,right:init.man.moveSpeed,up:-init.man.moveSpeed,down:init.man.moveSpeed}},getInitialState:function(){var t=init.man.initPos;return{indexShow:0,indexBoxShow:0,loadBoxShow:0,indexBox:0,start:"white",load:"transparent",end:"transparent",map:0,mapBg:init.map.bg,gridX:[],gridY:[],windowWidth:window.innerWidth,windowHeight:window.innerHeight,x:t.x,y:t.y,left:t.x-1,top:t.y-1,manMoveImg:0,manMoveAnimate:0,mapSizeX:1,mapSizeY:1,mapLeft:this.getManPosX(),mapTop:this.getManPosY(),mapAnimateSpeed:"0s",mapFade:0,mapZindex:-1,isMoveLeft:this.getMoveLUPoint(this.getWindowWidth()),isMoveRight:this.getMoveRDPoint(this.getWindowWidth()),isMoveUp:this.getMoveLUPoint(this.getWindowHeight()),isMoveDown:this.getMoveRDPoint(this.getWindowHeight()),StartTouchX:0,startTouchY:0,chatOpacity:0,chatZindex:-1,chatSelectArray:[],chatSelectIndex:-1,messageId:-1,message:"",messageName:!1,messageNum:-1,messageMax:-1}},event:function(t){-1!=this.state.messageId?this.state.messageMax>this.state.messageNum?(this.setState({messageNum:this.state.messageNum+1}),this.setState({message:React.createElement("p",null,init.event[this.state.map][t].text[this.state.messageNum])})):this.initEvent():this.setState({messageId:t,chatOpacity:1,chatZindex:2,message:React.createElement("p",null,init.event[this.state.map][t].text[0]),messageName:init.event[this.state.map][t].name,messageNum:0,messageMax:init.event[this.state.map][t].text.length-1})},eventSelect:function(t){if(-1!=this.state.messageId)this.state.messageMax>this.state.messageNum?(this.setState({messageNum:this.state.messageNum+1}),this.setState({message:React.createElement("p",null,init.event[this.state.map][t].select[this.state.chatSelectIndex].text[this.state.messageNum])})):this.initEvent();else{for(var e=[],i=0;i<init.event[this.state.map][t].select.length;i++)e.push(React.createElement("li",{className:"chatSelect",onMouseOut:this.handleMouseOut,onMouseOver:this.handleMouseOver.bind(null,i),onClick:this.handleEventSelect.bind(null,i)},init.event[this.state.map][t].select[i].title));this.setState({chatSelectIndex:0,chatSelectArray:e,messageId:t,chatOpacity:1,chatZindex:2,messageName:init.event[this.state.map][t].name}),$(".chatSelect").eq(this.state.chatSelectIndex).css("border-color","white")}},handleEventSelect:function(t){-1==this.state.messageNum?this.setState({chatSelectArray:[],message:React.createElement("p",null,init.event[this.state.map][this.state.messageId].select[t].text[0]),messageNum:0,messageMax:init.event[this.state.map][this.state.messageId].select[t].text.length-1}):this.eventSelect(this.state.messageId)},chatSelect:function(t){init.event[this.state.map][this.state.messageId].select.length>this.state.chatSelectIndex+t&&this.state.chatSelectIndex+t>-1&&($(".chatSelect").eq(this.state.chatSelectIndex).css("border-color","transParent"),this.setState({chatSelectIndex:this.state.chatSelectIndex+t}),$(".chatSelect").eq(this.state.chatSelectIndex).css("border-color","white"))},getWindowWidth:function(){return window.innerWidth},getWindowHeight:function(){return window.innerHeight},getMoveLUPoint:function(t){return Math.floor(t/4)-Math.floor(t/4)%init.man.moveSpeed},getMoveRDPoint:function(t){return Math.floor(t/4*3)-Math.floor(t/4*3)%init.man.moveSpeed},getManPosX:function(){if(init.man.initPos.x>this.getMoveRDPoint(this.getWindowWidth())){var t=Math.floor(window.innerWidth/2-init.man.initPos.x-init.man.sizeX/2);return t%init.man.moveSpeed!=0&&(t-=t%init.man.moveSpeed),t}return 0},getManPosY:function(){if(init.man.initPos.y>this.getMoveRDPoint(this.getWindowHeight())){var t=Math.floor(window.innerHeight/2-init.man.initPos.y-init.man.sizeY/2);return t%init.man.moveSpeed!=0&&(t-=t%init.man.moveSpeed),t}return 0},getResizeManPosX:function(){if(window.innerWidth-init.maps[this.state.map].col<0){if(this.state.x>this.getMoveRDPoint(this.getWindowWidth())){var t=Math.floor(window.innerWidth/2-this.state.x-init.man.sizeX/2);return t%init.man.moveSpeed!=0&&(t-=t%init.man.moveSpeed),t}return 0}var t=(window.innerWidth-init.maps[this.state.map].col)/2;return t},getResizeManPosY:function(){if(window.innerHeight-init.maps[this.state.map].row<0){if(this.state.y>this.getMoveRDPoint(this.getWindowHeight())){var t=Math.floor(window.innerHeight/2-this.state.y-init.man.sizeY/2);return t%init.man.moveSpeed!=0&&(t-=t%init.man.moveSpeed),t}return 0}var e=(window.innerHeight-init.maps[this.state.map].row)/2;return e},isMove:function(t,e){this.initEvent();for(var i=init.move[this.state.map]?init.move[this.state.map]:0,s=!0,n=0;n<i.length;n++)i[n].sx<=this.state.x+init.man.sizeX+t&&this.state.x+t<=i[n].ex&&i[n].sy<=this.state.y+e+init.man.sizeY&&this.state.y+e<=i[n].ey&&(i[n].cm>=0&&this.handleMap(i[n].cm,i[n].cmm),s=!1);return s},isEvents:function(t,e){var i=init.events[this.state.map];if(-1==this.state.messageId)for(var s=0;s<i.length;s++)i[s].sx<=this.state.x+init.man.sizeX+t&&this.state.x+t<=i[s].ex&&i[s].sy<=this.state.y+e+init.man.sizeY&&this.state.y+e<=i[s].ey&&(init.event[this.state.map][i[s].ev].select?this.eventSelect(i[s].ev):this.event(i[s].ev));else this.state.chatSelectIndex>-1?this.handleEventSelect(this.state.chatSelectIndex):this.event(this.state.messageId)},initEvent:function(){this.setState({chatOpacity:0,chatZindex:-1,messageId:-1,message:"",messageName:!1,messageNum:-1,messageMax:-1,chatSelectIndex:-1,chatSelectArray:[]})},handleKeyDown:function(t){if(t.preventDefault(),-1!=this.state.mapZindex)if(0==this.state.chatSelectArray.length)switch(t.keyCode){case 37:init.control.left=!0;break;case 65:init.control.left=!0;break;case 39:init.control.right=!0;break;case 68:init.control.right=!0;break;case 38:init.control.up=!0;break;case 87:init.control.up=!0;break;case 40:init.control.down=!0;break;case 83:init.control.down=!0;break;case 48:this.handleMap(0,0);break;case 49:this.handleMap(1,0);break;case 71:this.drawGrid();break;case 88:this.drawGridX();break;case 89:this.drawGridY();break;case 27:this.backIndex(),this.initEvent();break;case 32:this.moveAnimate();break;case 13:this.moveAnimate()}else switch(t.keyCode){case 38:this.chatSelect(-1);break;case 87:this.chatSelect(-1);break;case 40:this.chatSelect(1);break;case 83:this.chatSelect(1);break;case 32:this.moveAnimate();break;case 13:this.moveAnimate();break;case 27:this.initEvent()}else{switch(t.keyCode){case 38:this.handleIndexBoxMove(-1);break;case 87:this.handleIndexBoxMove(-1);break;case 40:this.handleIndexBoxMove(1);break;case 83:this.handleIndexBoxMove(1)}if(0==this.state.indexBox)switch(t.keyCode){case 32:this.handleStart();break;case 13:this.handleStart()}}},handleKeyUp:function(t){switch(t.preventDefault(),t.keyCode){case 37:this.leftStopMove();break;case 65:this.leftStopMove();break;case 39:this.rightStopMove();break;case 68:this.rightStopMove();break;case 38:this.upStopMove();break;case 87:this.upStopMove();break;case 40:this.downStopMove();break;case 83:this.downStopMove()}},leftStopMove:function(){init.control.left=!1,init.map.left=!1},rightStopMove:function(){init.control.right=!1,init.map.right=!1},upStopMove:function(){init.control.up=!1,init.map.up=!1},downStopMove:function(){init.control.down=!1,init.map.down=!1},handleResize:function(){this.setState({windowWidth:this.getWindowWidth(),windowHeight:this.getWindowHeight(),isMoveLeft:this.getMoveLUPoint(this.getWindowWidth()),isMoveRight:this.getMoveRDPoint(this.getWindowWidth()),isMoveUp:this.getMoveLUPoint(this.getWindowHeight()),isMoveDown:this.getMoveRDPoint(this.getWindowHeight()),mapLeft:this.getResizeManPosX(),mapTop:this.getResizeManPosY()})},handleMap:function(t,e){this.handleAnimateSpeed(".1s"),this.handleFade(0),setTimeout(function(){this.setState({map:t,left:init.maps[t]["in"][e].x-1,top:init.maps[t]["in"][e].y-1,x:init.maps[t]["in"][e].x,y:init.maps[t]["in"][e].y}),this.handleResize()}.bind(this),100),setTimeout(function(){this.handleFade(1)}.bind(this),200),setTimeout(function(){this.handleAnimateSpeed("0s")}.bind(this),300)},handleFade:function(t){this.setState({mapFade:t})},handleAnimateSpeed:function(t){this.setState({mapAnimateSpeed:t})},handleStart:function(){this.setState({mapZindex:1,indexBoxShow:0,indexShow:0}),setTimeout(function(){this.handleFade(1)}.bind(this),200)},backIndex:function(){this.setState({mapZindex:-1,indexBoxShow:1,indexShow:1}),setTimeout(function(){this.handleFade(0)}.bind(this),200)},handleIndexBoxMove:function(t){switch(this.state.indexBox){case 0:this.setState({start:"transparent"});break;case 1:this.setState({load:"transparent"});break;case 2:this.setState({end:"transparent"})}switch(this.state.indexBox+t>2?t=(this.state.indexBox+t)%3:(t=this.state.indexBox+t,-1==t&&(t=2)),t){case 0:this.setState({indexBox:t,start:"white"});break;case 1:this.setState({indexBox:t,load:"white"});break;case 2:this.setState({indexBox:t,end:"white"})}},handleMouseOver:function(t,e){if(-1!=this.state.mapZindex)t!=this.state.chatSelectIndex&&$(".chatSelect").eq(this.state.chatSelectIndex).css("border-color","transParent"),e.target.style.borderColor="white",this.setState({chatSelectIndex:t});else{switch(this.state.indexBox){case 0:this.setState({start:"transparent"});break;case 1:this.setState({load:"transparent"});break;case 2:this.setState({end:"transparent"})}switch(t){case 0:this.setState({indexBox:t,start:"white"});break;case 1:this.setState({indexBox:t,load:"white"});break;case 2:this.setState({indexBox:t,end:"white"})}}},componentWillMount:function(){},componentDidMount:function(){$(window).on("load",this.backIndex),$(window).on("resize",this.handleResize),$(window).on("keydown",this.handleKeyDown),$(window).on("keyup",this.handleKeyUp),$(".object").on("click","div[style*='cursor']",this.moveAnimate),this.timer=setInterval(this.move.bind(this),init.man.moveSetInterVal)},componentWillUnmount:function(){$(window).off("resize",this.handleResize),$(window).off("keydown",this.handleKeyDown),$(window).off("keyup",this.handleKeyUp),$(".object").off("click",this.moveAnimate),clearInterval(this.timer)},getTouchPos:function(t){return{x:t.changedTouches[0].pageX,y:t.changedTouches[0].pageY}},handleTouchStart:function(t){var e=this.getTouchPos(t);this.setState({startTouchX:e.x,startTouchY:e.y})},handleTouchMove:function(t){var e=this.getTouchPos(t);return e.x-this.state.startTouchX<-50?init.control.left=!0:(init.control.left=!1,init.map.left=!1),e.x-this.state.startTouchX>50?init.control.right=!0:(init.control.right=!1,init.map.right=!1),e.y-this.state.startTouchY<-50?init.control.up=!0:(init.control.up=!1,init.map.up=!1),e.y-this.state.startTouchY>50?init.control.down=!0:(init.control.down=!1,init.map.down=!1),!1},handleTouchEnd:function(t){init.control.left=!1,init.map.left=!1,init.control.right=!1,init.map.right=!1,init.control.up=!1,init.map.up=!1,init.control.down=!1,init.map.down=!1},drawGrid:function(){this.drawGridX(),this.drawGridY()},drawGridX:function(){if(0==this.state.gridX.length){for(var t=[],e=0;e<init.maps[this.state.map].row/init.object.sizeY;e++)t.push(React.createElement("div",{className:"gridY",title:"Y : "+e*init.object.sizeY,style:{width:init.maps[this.state.map].col,height:init.object.sizeY,left:0,top:init.object.sizeY*e}},e*init.object.sizeY));this.setState({gridX:t})}else this.setState({gridX:[]})},drawGridY:function(){if(0==this.state.gridY.length){for(var t=[],e=0;e<init.maps[this.state.map].col/init.object.sizeX;e++)t.push(React.createElement("div",{className:"gridX",title:"X : "+init.object.sizeX*e,style:{width:init.object.sizeX,height:init.maps[this.state.map].row,top:0,left:init.object.sizeX*e}},init.object.sizeX*e));this.setState({gridY:t})}else this.setState({gridY:[]})},moveAnimate:function(){switch(this.state.manMoveImg){case 3:this.isEvents(this.props.left,0);break;case 2:this.isEvents(this.props.right,0);break;case 1:this.isEvents(0,this.props.up);break;case 4:this.isEvents(0,this.props.down)}},move:function(){var t=this.state,e=this.props,i=init.control,s=init.map;if((i.left||i.right||i.up||i.down)&&this.setState({manMoveAnimate:(t.manMoveAnimate+1)%4}),i.left&&this.setState({manMoveImg:3}),i.right&&this.setState({manMoveImg:2}),i.up&&this.setState({manMoveImg:1}),i.down&&this.setState({manMoveImg:4}),i.left&&t.x>e.min){var n=this.isMove(e.left,0);n?(this.setState({x:t.x+e.left,left:e.left*t.mapSizeX+t.left}),s.left=0!=t.mapLeft&&t.isMoveLeft-t.mapLeft==t.x?!0:!1):s.left=!1}if(i.right&&init.maps[this.state.map].col-init.man.sizeX*t.mapSizeX>t.x){var a=this.isMove(e.right,0);a?(this.setState({x:t.x+e.right,left:e.right*t.mapSizeX+t.left}),s.right=t.mapSizeX*init.maps[this.state.map].col+t.mapLeft>t.windowWidth&&t.isMoveRight-t.mapLeft==t.x?!0:!1):s.right=!1}if(i.up&&t.y>e.min){var o=this.isMove(0,e.up);o?(this.setState({y:t.y+e.up,top:e.up*t.mapSizeY+t.top}),s.up=0!=t.mapTop&&t.isMoveUp-t.mapTop==t.y?!0:!1):s.up=!1}if(i.down&&init.maps[this.state.map].row-init.man.sizeY*t.mapSizeY>t.y){var h=this.isMove(0,e.down);h?(this.setState({y:t.y+e.down,top:e.down*t.mapSizeY+t.top}),s.down=t.mapSizeY*init.maps[this.state.map].row+t.mapTop>t.windowHeight&&t.isMoveDown-t.mapTop==t.y?!0:!1):s.down=!1}s.left&&this.setState({mapLeft:t.mapLeft-e.left}),s.right&&this.setState({mapLeft:t.mapLeft-e.right}),s.up&&this.setState({mapTop:t.mapTop-e.up}),s.down&&this.setState({mapTop:t.mapTop-e.down})},render:function(){var t=this.state,e=init.maps;return React.createElement("body",null,React.createElement("div",{id:"index",style:{opacity:t.indexShow}},React.createElement("div",{id:"indexBox",style:{opacity:t.indexBoxShow}},React.createElement("ul",null,React.createElement("li",{style:{borderColor:t.start},onMouseOver:this.handleMouseOver.bind("null",0),onClick:this.handleStart},"START"),React.createElement("li",{style:{borderColor:t.load},onMouseOver:this.handleMouseOver.bind("null",1)},"LOAD"),React.createElement("li",{style:{borderColor:t.end},onMouseOver:this.handleMouseOver.bind("null",2)},"END"))),React.createElement("div",{id:"loadBox",style:{opacity:t.loadBoxShow}}," ")),React.createElement("div",{id:"map",style:{zIndex:t.mapZindex,transition:t.mapAnimateSpeed,opacity:t.mapFade,background:e[t.map].bg,transform:"translate3D("+t.mapLeft+"px,"+t.mapTop+"px,0)",width:t.mapSizeX*e[t.map].col,height:t.mapSizeY*e[t.map].row},onTouchStart:this.handleTouchStart,onTouchMove:this.handleTouchMove,onTouchEnd:this.handleTouchEnd},React.createElement("div",{className:"man-container",style:{transform:"translate3D("+t.left+"px,"+t.top+"px,0)",width:t.mapSizeX*init.man.sizeX,height:t.mapSizeY*init.man.sizeY,backgroundPosition:32*t.manMoveAnimate+"px "+48*t.manMoveImg+"px"}}),React.createElement("div",{className:"object"},init.arr[t.map]),React.createElement("div",{className:"gridbox"},t.gridX,t.gridY)),React.createElement("div",{className:"chat",onClick:this.moveAnimate,style:{opacity:t.chatOpacity,zIndex:t.chatZindex}},t.messageName," : ",t.message,React.createElement("ul",null,t.chatSelectArray)))}});React.render(React.createElement(Root,null),document.body);